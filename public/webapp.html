<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Auto Source</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
<script>
(function(){
  const tg = window.Telegram && window.Telegram.WebApp;
  if(!tg){ location.href = "https://t.me/rgnr_assistant_bot"; return; }
  tg.ready();
  // Берём start_param из Telegram и src из URL как запасной вариант
  const sp = (tg.initDataUnsafe && tg.initDataUnsafe.start_param) || "";
  const urlSrc = new URLSearchParams(location.search).get("src") || "";
  const grab = s => {
    const m = (s||"").match(/(?:^|__)(?:src[:=]|s[:=])([A-Za-z0-9._-]{1,64})/i);
    return m ? m[1].toLowerCase() : "";
  };
  const slug = grab(sp) || grab(urlSrc) || urlSrc || "";

  // Отправляем боту и закрываемся
  try { tg.sendData(JSON.stringify({ type:"src", src: slug })); } catch(e){}
  setTimeout(()=>{ try{ tg.close(); }catch(e){} }, 120);
})();
</script>
</body>
</html>
